<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Etch Sketch</title>
        <script src="./code.js"></script>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div class="header">
            <h1 style="margin: 10px;">Pixel Sketcher</h1>
        </div>
        <div class="content">
            <div class="grid"></div>
            <div style="display: flex; justify-content: center;">
            <div class="options">
                <button class="grid_size button-27">NEW GRID</button>
                <button class="clear_grid button-27">CLEAR GRID</button>
                <button class="rand_color button-27">RANDOM COLOR</button>
            </div>
            </div>
        </div>
    </div>
    <script>
        const gridsize = 544;
        let numOfSquare = 16;

        let grid = document.querySelector(".grid");
        grid.style.display = "flex";
        grid.style.justifyContent ='center';

        let r = document.querySelector(':root');

        resizeGrid(numOfSquare);
        addListeners();

        const gridBtn = document.querySelector(".grid_size");
        gridBtn.addEventListener('click', promptNewGrid);

        const clearBtn = document.querySelector(".clear_grid");
        clearBtn.addEventListener('click', () => {
            removeGrid();
            resizeGrid(numOfSquare);
        })

        const randColorBtn = document.querySelector(".rand_color");
        randColorBtn.addEventListener('click', () => {
            removeGrid();
            resizeGrid(numOfSquare);
            const boxes = document.querySelectorAll(".box")
            boxes.forEach(box => box.addEventListener("mouseover", () => {
                    if (isMouseDown == true) {
                        let randomColor = '#'+Math.floor(Math.random()*16777215).toString(16);
                        r.style.setProperty("--fill-color", randomColor);
                        box.classList.add("hoveringover");
                    }
            }))
        })


        function addListeners() {
            const boxes = document.querySelectorAll(".box")
            boxes.forEach(box => box.addEventListener("mouseover", () => {
                if (isMouseDown == true) {
                box.classList.add("hoveringover")
                }
            }))

            boxes.forEach(box => box.addEventListener("transitionend", () => {
                box.classList.remove("hoveringover")
            }))

            
        }
        
        function promptNewGrid() {
            let value = 0;
            do {
                value = parseInt(prompt("Please choose a new grid size (MAX at 100):"));
                if (isNaN(value) || value > 100) {
                    alert("Unaccepted input, try again.")
                }
                console.log(value);
            } while (isNaN(value) || value > 100)

            removeGrid();
            resizeGrid(value);
        }

        function removeGrid() {
            const columns = document.querySelectorAll('.column');
            columns.forEach(column => {
                grid.removeChild(column);
            });
        }

        function resizeGrid(value) {
            numOfSquare = value;
            
            for (let i = 0; i < value; i++) {
                let column = document.createElement('div');
                column.classList.add("column");

                for (let i = 0; i < value; i++) {
                    let boxSize = (gridsize / value) - 2;
                    let box = document.createElement('div');
                    box.style.border = "1px dashed black";
                    box.style.minWidth = `${boxSize}px`;
                    box.style.minHeight = `${boxSize}px`;
                    box.classList.add("box");
                    column.appendChild(box);
                }

                grid.appendChild(column);
            }

            addListeners();
        }
    </script>
    </body>
</html>